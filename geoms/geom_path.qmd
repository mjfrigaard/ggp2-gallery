---
title: "`geom_path()`"
format:
  html:
    toc: true
    code-fold: show
    df-print: paged
execute:
  warning: false
  message: false
---

```{r}
#| label: setup
#| message: false
#| warning: false
#| include: false
library(tidyverse)
library(lubridate)
library(scales)
library(knitr)
library(kableExtra)
library(colorblindr)
library(downlit)
library(patchwork)
library(faux)
# options ----
options(
  repos = "https://cloud.r-project.org",
  dplyr.print_min = 6, 
  dplyr.print_max = 6, 
  scipen = 9999)
# fonts ----
library(extrafont)
library(sysfonts)
# import font
extrafont::font_import(
    paths = "../assets/Ubuntu/",
    prompt = FALSE)
# add font
sysfonts::font_add(
    family =  "Ubuntu", 
    regular = "../assets/Ubuntu/Ubuntu-Regular.ttf")
# use font
showtext::showtext_auto()
# add theme
source("../R/theme_ggp2g.R")
# set theme
ggplot2::theme_set(theme_ggp2g(
    base_size = 16))
# install data packages ----
install.packages("palmerpenguins")
```


:::: {.callout-tip collapse="false" icon=false}
## Lines in `ggplot2`

::: {style="color: #38B44A;"}
#### Primary geoms for lines
:::

```{r}
#| label: full_code_display
#| eval: true
#| echo: false
#| warning: false
#| message: false
#| out-height: '55%'
#| out-width: '55%'
#| fig-align: right
library(palmerpenguins) 
library(ggplot2)
library(patchwork)
economics <- ggplot2::economics
seals <- ggplot2::seals
ggp2_line_base <- ggplot(data = economics, 
    aes(x = date, y = unemploy))
# geom_path ----
pth <- ggp2_line_base + 
    geom_path() + 
    theme_void() + 
    labs(title = "geom_path()")
# geom_line ----
ln <- ggp2_line_base + 
    geom_line() + 
    theme_void() + 
    labs(title = "geom_line()")
# geom_step ----
stp <- ggp2_line_base + 
    geom_step() + 
    theme_void() + 
    labs(title = "geom_step()")
# path, line, step ----
pth + ln + stp + 
    patchwork::plot_layout(ncol = 2)
```


  - `geom_path()`  

  - `geom_line()`  

  - `geom_step()` 
  
::::

:::: {.panel-tabset}

### Packages

::: {.column-margin}
::: {style="font-size: 0.75em;"}
![](../www/ggplot2.png){fig-align="right" width="40%" height="40%"}
:::
:::

::: {style="font-size: 0.90em; color: #1e83c8;"}
**PACKAGES:**
:::

::: {style="font-size: 0.85em;"}
Install packages.
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: pkg_code_lines
#| eval: true
#| echo: true
#| warning: false
#| message: false
#| results: hide
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
install.packages("ggplot2")
library(ggplot2)
```
:::

### Data

::: {style="font-size: 0.90em; color: #1e83c8;"}
**DATA:**
:::

::: {style="font-size: 0.85em;"}
Load the `ggplot2::economics` data.
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: data_lines
#| eval: true
#| echo: true
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
economics <- ggplot2::economics
dplyr::glimpse(economics)
```
:::
::::

## `geom_path()`

:::: {.panel-tabset}

### Basic Use

::: {style="font-size: 0.90em; color: #1e83c8;"}
**BASICS:**
:::

::: {style="font-size: 0.85em;"}
Below is a quick demonstration of a line graph with `geom_path()` using a `date` variable on the `x` axis and a numeric (double) variable on the `y` axis. 
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: basic_path
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 1
ggp2_path_base <- ggplot(data = economics, 
    aes(x = date, y = unemploy))
ggp2_path_base + geom_path()
```
:::

::: {style="font-size: 0.85em;"}
 [`geom_path()`](https://ggplot2.tidyverse.org/reference/geom_path.html) *connects the observations in the order in which they appear in the data.*
:::

### Aesthetics

::: {style="font-size: 0.90em; color: #1e83c8;"}
**AESTHETICS:**
:::

::: {style="font-size: 0.85em;"}
The required aesthetics are: `x` and `y` positions 
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: req_aes_path
#| eval: true
#| echo: true
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
ggp2_path_base <- ggplot(economics) 
ggp2_path_base + 
    geom_path(aes(x = date, 
                  y = uempmed))
```
:::

::: {style="font-size: 0.85em;"}
Optional aesthetics include: 

  - `color`   
  
  - `linewidth`  
  
  - `alpha`  
  
  - `linetype`  
  
  - `group`  
:::

#### `color`

::: {style="font-size: 0.85em;"}
The `color` aesthetic can be set or mapped, and is useful for differentiating categorical levels.
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: aes_path_color
#| eval: true
#| echo: true
#| code-fold: true
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
ggp2_path_base <- ggplot(economics) 
ggp2_path_base_long <- ggplot(economics_long)
# mapped color
ggp2_path_base_long + 
    geom_path(aes(x = date, 
        y = value01, 
        color = variable))
# set color
ggp2_path_base + 
    geom_path(aes(x = date, 
        y = uempmed),
        color = "#007bff")
```
:::

#### `linewidth`

::: {style="font-size: 0.85em;"}
The `linewidth` determines the size of the line. 
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: aes_path_linewidth
#| eval: true
#| echo: true
#| code-fold: true
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 1
# color, linewidth
ggp2_path_base_long + 
    geom_path(aes(x = date, 
        y = value01, 
        color = variable),
        linewidth = 0.75)
```
:::

#### `alpha`

::: {style="font-size: 0.85em;"}
The alpha sets the opacity of the line (and is useful for overlapping lines).
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: aes_path_alpha
#| eval: true
#| echo: true
#| code-fold: true
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 1
# color, alpha, linewidth
ggp2_path_base_long + 
    geom_path(aes(x = date, 
        y = value01, 
        color = variable), 
        alpha = 1 / 2,
        linewidth = 0.75)
```
:::

#### `linetype`

::: {style="font-size: 0.85em;"}
The `linetype` can be mapped or set with values from [ggplot2-specs](https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#lines)
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: aes_path_linetype
#| eval: true
#| echo: true
#| code-fold: true
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 1
# map group, color, linetype, with facets 
ggp2_path_base_long + 
    geom_path(aes(x = date, 
        y = value01, 
        color = variable, 
        group = variable,
        linetype = variable)) + 
    facet_wrap(. ~ variable, ncol = 2) + 
    theme(legend.position = "none")
```
:::

### Additional Arguments

::: {style="font-size: 0.90em; color: #1e83c8;"}
**ARGUMENTS:**
:::

::: {style="font-size: 0.85em;"}
We've defined two functions for displaying the arguments in `geom_path()`: `path_linetype()` displays the different `linetype` options, and `path_lines()` displays the options for `lineend` and `linejoin`.
:::

#### `linetype`

::: {style="font-size: 0.85em;"}
We've defined `path_linetype()`, a function that lets us quickly specify the `linetype` aesthetic for `geom_path()`:
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: path_linetype
#| eval: true
#| echo: true
#| code-fold: true
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
path_linetype <- function(type = "solid") {
    df <- data.frame(x = 1:5, y = c(5, 1, 4, 2, 7))
    ggplot2::ggplot(data = df,
        mapping = aes(x = x, y = y)) +
            xlim(0.5, 5.5) +
            ylim(0, 10) + 
        ggplot2::geom_path(
            linewidth = 15,
            lineend = "round",
            linetype = "solid") + 
        ggplot2::geom_path(
            linewidth = 1.5,
            color = "#ffffff",
            linetype = type) + 
        ggplot2::labs(subtitle = type)
}
```
:::

::: {style="font-size: 0.85em;"}
The white line displays the `linetype` against a black backdrop to enhance visibility. See the `lineend` argument in the section below: 
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: draw_path_linetype_use
#| eval: true
#| echo: true
#| code-fold: true
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
# manually set linetype
# type = one of: "solid", "dashed", "dotted", "dotdash",
# "longdash", "twodash"
path_linetype(type = "dashed")
path_linetype(type = "dotted")
path_linetype(type = "dotdash")
path_linetype(type = "longdash")
path_linetype(type = "twodash")
path_linetype(type = "solid")
```
:::

::: {style="font-size: 0.85em;"}
Below the define `path_lines()`, which builds line graphs with  `geom_path()`'s `lineend` and `linejoin` arguments set to `"round"`, `"butt"`, or `"square"` and `"bevel"`, `"round"`, and `"mitre"`. 

The `linewidth` (`lw`) and `linemitre` (`lnmtr`) can be adjusted to exaggerate their effects.

We've added white lines/points to illustrate the data points.
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: path_lines
#| code-fold: true
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
path_lines <- function(lw = 5, lend = 'r', ljoin = 'r', lnmtr = NULL) {
    lineends <- c('r' = 'round', 'b' = 'butt', 's' = 'square')
    linejoins <- c('r' = 'round', 'm' = 'mitre', 'b' = 'bevel')
    ljoin <- linejoins[ljoin]
    lend <- lineends[lend]
    df <- data.frame(x = 1:5, y = c(5, 1, 4, 2, 7))
    ggplot2::ggplot(data = df,
        mapping = aes(x = x, y = y)) +
        xlim(0.5, 5.5) +
        ylim(0, 10) +
        ggplot2::geom_path(
            linewidth = lw,
            lineend = lend,
            linejoin = ljoin,
            linemitre = lnmtr
        ) + 
        geom_path(color = "#ffffff") +
        geom_point(size = 3, color = "#ffffff") +
        ggplot2::labs(title = paste0(
            "lineend = ", lend,
            " / ", 
            "linejoin = ", ljoin), 
            subtitle = paste0("linewidth = ", lw))
}
```
:::

#### Lineend: `round`

::: {style="font-size: 0.85em;"}
A "round" line ending extends the line width slightly and produces curved caps at the start and end of the line (with the intersecting values at the center).

*The white line/points are the data points*
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: args_path_lend_round
#| code-fold: true
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
path_lines(lw = 15, lend = "r", ljoin = "r") # round/round
path_lines(lw = 15, lend = "r", ljoin = "m") # round/mitre 
path_lines(lw = 15, lend = "r", ljoin = "b") # round/bevel 
```
:::

#### Linejoin: `round`

::: {style="font-size: 0.85em;"}
A "round" line join produces a curve at the intersection of points on the line.

*The white line/points are the data points*
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: args_path_ljoin_round
#| code-fold: true
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
path_lines(lw = 15, lend = "r", ljoin = "r") # round/round
path_lines(lw = 15, lend = "b", ljoin = "r") # butt/round
path_lines(lw = 15, lend = "s", ljoin = "r") # square/round
```
:::

#### Lineend: `butt`

::: {style="font-size: 0.85em;"}
A "butt" line end produces an abrupt ending at the start and end of the data points along the line.

*The white line/points are the data points*
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: args_path_lend_butt
#| code-fold: true
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
path_lines(lw = 15, lend = "b", ljoin = "r") # butt/round
path_lines(lw = 15, lend = "b", ljoin = "m") # butt/mitre 
path_lines(lw = 15, lend = "b", ljoin = "b") # butt/bevel 
```
:::

#### Linejoin: `mitre`

::: {style="font-size: 0.85em;"}
A "mitre" line join extends the area of the line width between intersecting points, giving each connecting point a straight edge. 

*The white line/points are the data points*
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: args_path_ljoin_mitre
#| code-fold: true
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
path_lines(lw = 15, lend = "b", ljoin = "m") # butt/mitre 
path_lines(lw = 15, lend = "s", ljoin = "m") # square/mitre 
path_lines(lw = 15, lend = "r", ljoin = "m") # round/mitre 
```
:::

#### Lineend: `square`

::: {style="font-size: 0.85em;"}
A "square" line ending extends the line width slightly and produces a square cap at the start and end of the line (with the intersecting values at the center).

*The white line/points are the data points*
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: args_path_lend_square
#| code-fold: true
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
path_lines(lw = 15, lend = "s", ljoin = "r") # square/round
path_lines(lw = 15, lend = "s", ljoin = "m") # square/mitre 
path_lines(lw = 15, lend = "s", ljoin = "b") # square/bevel
```
:::

#### Linejoin: `bevel`

::: {style="font-size: 0.85em;"}
A "bevel" line join 'shaves' the line width at the intersection of data points and curves the line with by producing two additional angles (with the intersecting values at the center of the two angles).

*The white line/points are the data points*
:::

::: {style="font-size: 0.75em;"}
```{r}
#| label: args_path_ljoin_bevel
#| code-fold: true
#| eval: true
#| echo: true 
#| warning: false
#| message: false
#| column: page-inset-right
#| out-height: '100%'
#| out-width: '100%'
#| layout-ncol: 2
path_lines(lw = 15, lend = "b", ljoin = "b") # butt/bevel 
path_lines(lw = 15, lend = "s", ljoin = "b") # square/bevel
path_lines(lw = 15, lend = "r", ljoin = "b") # round/bevel 
```
:::

::::
